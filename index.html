<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stock Advisor Chatbot</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap.min.css">
    <style>
        body {
            background-color: #f5f5f5;
            font-family: Arial, sans-serif;
        }
        .chat-container {
            max-width: 600px;
            margin: 50px auto;
            background-color: #fff;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
            padding: 20px;
        }
        .chat-header {
            text-align: center;
            margin-bottom: 20px;
        }
        .chat-messages {
            height: 400px;
            overflow-y: auto;
            border: 1px solid #ddd;
            padding: 15px;
            border-radius: 5px;
            background-color: #f9f9f9;
        }
        .chat-message {
            margin-bottom: 15px;
        }
        .chat-message.user {
            text-align: right;
        }
        .chat-input {
            margin-top: 20px;
        }
        .chat-bot {
            color: #333;
            background-color: #e0e0e0;
            padding: 8px 12px;
            border-radius: 12px;
            display: inline-block;
        }
        .chat-user {
            color: #fff;
            background-color: #007bff;
            padding: 8px 12px;
            border-radius: 12px;
            display: inline-block;
        }
    </style>
</head>
<body>

<div class="chat-container">
    <div class="chat-header">
        <h2>Stock Advisor Chatbot</h2>
    </div>
    <div class="chat-messages" id="chat-messages">
        <div class="chat-message bot">
            <div class="chat-bot">Hello! Letâ€™s get started. How much money do you have to invest?</div>
        </div>
    </div>
    <div class="chat-input">
        <input type="text" id="user-input" class="form-control" placeholder="Type your response here...">
        <button id="send-button" class="btn btn-primary mt-2">Send</button>
    </div>
</div>

<script>
    const chatMessages = document.getElementById("chat-messages");
    const userInput = document.getElementById("user-input");
    const sendButton = document.getElementById("send-button");

    let questionIndex = 0;
    const questions = [
        "How much money do you have to invest?",
        "What sector do you want to invest in (e.g., technology, healthcare, etc.)?",
        "When do you want to withdraw the money, or do you have a specific target?"
    ];

    let userResponses = [];

    function addMessage(content, sender = "bot") {
        const messageDiv = document.createElement("div");
        messageDiv.className = `chat-message ${sender}`;
        const messageContent = document.createElement("div");
        messageContent.className = sender === "bot" ? "chat-bot" : "chat-user";
        messageContent.textContent = content;
        messageDiv.appendChild(messageContent);
        chatMessages.appendChild(messageDiv);
        chatMessages.scrollTop = chatMessages.scrollHeight;
    }

    function askNextQuestion() {
        if (questionIndex < questions.length) {
            addMessage(questions[questionIndex]);
            questionIndex++;
        } else {
            submitResponses();
        }
    }

    function submitResponses() {
        addMessage("Great! Let me analyze your inputs and find the best stock for you...", "bot");

        fetch("https://your-backend-url.com/get_stock_recommendation", {
            method: "POST",
            headers: {
                "Content-Type": "application/json",
            },
            body: JSON.stringify({ responses: userResponses }),
        })
            .then((response) => response.json())
            .then((data) => {
                if (data.recommendation) {
                    addMessage(`Here's the recommended stock: ${data.recommendation}`, "bot");
                } else {
                    addMessage("Sorry, something went wrong. Please try again.", "bot");
                }
            })
            .catch((error) => {
                console.error("Error:", error);
                addMessage("Sorry, there was an error processing your request.", "bot");
            });
    }

    sendButton.addEventListener("click", () => {
        const userText = userInput.value.trim();
        if (userText) {
            addMessage(userText, "user");
            userResponses.push(userText);
            userInput.value = "";
            askNextQuestion();
        }
    });

    // Start the conversation
    askNextQuestion();
</script>

</body>
</html>
